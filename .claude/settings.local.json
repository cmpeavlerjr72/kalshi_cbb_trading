{
  "permissions": {
    "allow": [
      "Bash(head:*)",
      "Bash(grep:*)",
      "Bash(wc:*)",
      "Bash(cd:*)",
      "Bash(cd /c/Users/cmpea/Kalshi && PYTHONIOENCODING=utf-8 python -c \"\nimport sys\nsys.path.insert\\(0, '.'\\)\nfrom combo_vnext import fetch_orderbook, derive_prices\n\nspread_tickers = [\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-LOU11',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-LOU14',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-LOU17',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-LOU2',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-LOU5',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-LOU8',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-UNC1',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-UNC10',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-UNC13',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-UNC4',\n    'KXNCAAMBSPREAD-26FEB23LOUUNC-UNC7',\n]\n\nml_ticker = 'KXNCAAMBGAME-26FEB23LOUUNC-LOU'\n\nprint\\('=== ML MARKET ==='\\)\ntry:\n    ob = fetch_orderbook\\(ml_ticker\\)\n    px = derive_prices\\(ob\\)\n    yb = px['best_yes_bid']\n    ya = px['imp_yes_ask']\n    nb = px['best_no_bid']\n    na = px['imp_no_ask']\n    spread = \\(ya - yb\\) if yb and ya else None\n    yl = px.get\\('yes_levels', []\\)[:3]\n    nl = px.get\\('no_levels', []\\)[:3]\n    print\\(f'  {ml_ticker}'\\)\n    print\\(f'    YES bid={yb} ask={ya} | NO bid={nb} ask={na} | spread={spread}c'\\)\n    print\\(f'    YES depth: {yl}'\\)\n    print\\(f'    NO  depth: {nl}'\\)\nexcept Exception as e:\n    print\\(f'  ERROR: {e}'\\)\n\nprint\\(\\)\nprint\\('=== SPREAD MARKETS ==='\\)\nprint\\(f'{\\\\\"Ticker\\\\\":<50} {\\\\\"Y_bid\\\\\":>5} {\\\\\"Y_ask\\\\\":>5} {\\\\\"N_bid\\\\\":>5} {\\\\\"N_ask\\\\\":>5} {\\\\\"Sprd\\\\\":>5} {\\\\\"Y_dep\\\\\":>8} {\\\\\"N_dep\\\\\":>8}'\\)\nprint\\('-' * 100\\)\n\nfor t in sorted\\(spread_tickers\\):\n    try:\n        ob = fetch_orderbook\\(t\\)\n        px = derive_prices\\(ob\\)\n        yb = px['best_yes_bid']\n        ya = px['imp_yes_ask']\n        nb = px['best_no_bid']\n        na = px['imp_no_ask']\n        spread = \\(ya - yb\\) if yb and ya else None\n\n        # total depth \\(qty\\) on each side\n        y_depth = sum\\(lvl[1] for lvl in px.get\\('yes_levels', []\\)\\)\n        n_depth = sum\\(lvl[1] for lvl in px.get\\('no_levels', []\\)\\)\n\n        # short label\n        label = t.split\\('-'\\)[-1]\n        print\\(f'  {label:<48} {str\\(yb\\):>5} {str\\(ya\\):>5} {str\\(nb\\):>5} {str\\(na\\):>5} {str\\(spread\\):>5} {y_depth:>8} {n_depth:>8}'\\)\n    except Exception as e:\n        label = t.split\\('-'\\)[-1]\n        print\\(f'  {label:<48} ERROR: {e}'\\)\n\" 2>&1)",
      "Bash(true:*)",
      "Bash(cd /c/Users/cmpea/Kalshi && timeout 15 python -c \"\nfrom dashboard import discover_dates, discover_games\ndates = discover_dates\\(\\)\nprint\\('Available dates:', dates\\)\nif dates:\n    games = discover_games\\(dates[0]\\)\n    for g in games:\n        print\\(f\\\\\"  Game: {g['game']}, Tickers: {g['tickers']}\\\\\"\\)\n\" 2>&1)",
      "Bash(cd /c/Users/cmpea/Kalshi && timeout 8 python -c \"\nfrom dashboard import build_dashboard_data\nimport json\ndata = build_dashboard_data\\('2026-02-22'\\)\nprint\\(json.dumps\\(data, indent=2, default=str\\)[:500]\\)\n\" 2>&1)",
      "Bash(cd /c/Users/cmpea/Kalshi && timeout 8 python -c \"\n# Quick server start/stop test\nfrom dashboard import DashboardHandler, DASHBOARD_HTML\nfrom http.server import HTTPServer\nimport threading, time, urllib.request\n\nserver = HTTPServer\\(\\('127.0.0.1', 8050\\), DashboardHandler\\)\nt = threading.Thread\\(target=server.serve_forever, daemon=True\\)\nt.start\\(\\)\ntime.sleep\\(1\\)\n\n# Test the HTML endpoint\nresp = urllib.request.urlopen\\('http://127.0.0.1:8050/'\\)\nhtml = resp.read\\(\\).decode\\(\\)\nprint\\(f'GET / : {resp.status}, {len\\(html\\)} bytes'\\)\nassert 'KALSHI LIVE DASHBOARD' in html\nprint\\('HTML title found OK'\\)\n\n# Test the API endpoint  \nresp2 = urllib.request.urlopen\\('http://127.0.0.1:8050/api/dates'\\)\nprint\\(f'GET /api/dates : {resp2.status}'\\)\n\nresp3 = urllib.request.urlopen\\('http://127.0.0.1:8050/api/data?date=2026-02-22'\\)\nprint\\(f'GET /api/data : {resp3.status}'\\)\n\nserver.shutdown\\(\\)\nprint\\('All endpoints working!'\\)\n\" 2>&1)"
    ]
  }
}
