# 2025-02-06 — Live Kalshi Trading Test Plan

## Purpose

This document defines **exactly what is being tested**, **why it is being tested this way**, and **how results should be evaluated later** for the 02/06/2025 live Kalshi trading run.

The goal is to create a durable reference so that future analysis can clearly distinguish:

* Strategy logic vs. execution quality
* Model edge vs. market behavior
* Intended behavior vs. accidental outcomes

This test is **not** intended to fully optimize parameters. It is a controlled validation run.

---

## High-Level Objective

Validate that the **multi-strategy live trading system** behaves as designed when:

1. Entering positions pregame using anchored pricing
2. Managing positions live using model edge and mean reversion
3. Exiting positions using lock / take-profit / stop-loss logic
4. Logging sufficient data to allow post-hoc evaluation of decisions

---

## What Is Explicitly In Scope

### Strategies Under Test

The following strategies are active **simultaneously** per game:

1. **PregameAnchoredStrategy**

   * Single pregame entry attempt
   * Anchored to model + partner win probability
   * Entry window driven by ESPN `secs_to_tip`
   * No re-entry after failure

2. **ModelEdgeStrategy**

   * Live evaluation of model edge vs. market mid
   * Exit via:

     * Lock profit
     * Take-profit
     * Stop-loss
   * Model blend includes ESPN live win % when available

3. **MeanReversionStrategy**

   * Market microstructure-based (price volatility driven)
   * Uses rolling window (warmup required)
   * Requires minimum price range before activation

### Data Inputs

#### Market Data

* Kalshi YES / NO orderbook snapshots
* Mid price and bid-ask spread
* Market quality diagnostics (std dev, spread)

#### Model Data

* Simulator win probability (`p_win`)
* Partner win probability (**placeholder = 0 during setup; updated before tip**)

#### Game State Data

* ESPN live context:

  * `secs_to_tip`
  * `secs_to_game_end`
  * `game_progress`
  * `espn_live_win_pct`

### Execution Framework

* One thread per game
* Shared bankroll, strategy-level capital caps
* Continuous polling loop
* All order placement via limit orders

---

## What Is Explicitly NOT In Scope

* Spread markets
* Totals markets
* Score-based or play-by-play-based strategies
* Dynamic bankroll resizing during the run
* Parameter optimization or hyper-tuning

This is a **behavioral and plumbing test**, not a profit maximization exercise.

---

## Why This Test Is Structured This Way

### Pregame + Live Combination

We want to test the hypothesis that:

* **Pregame mispricing capture** provides a favorable starting position
* **Live market noise** can then be exploited independently of final outcome

This mirrors a **day-trading-style approach** applied to sports markets:

* Fundamentals set bias
* Volatility provides opportunity

### ESPN Clock Integration

Using ESPN clock data allows us to:

* Precisely gate pregame entry timing
* Avoid arbitrary Kalshi close-time heuristics
* Align strategy decisions with actual game state

A key validation is whether **ESPN matching is reliable enough** to serve as a control signal.

### Multiple Independent Exit Signals

Rather than a single exit rule, we intentionally allow:

* Lock
* Take-profit
* Stop-loss

This lets us later ask:

* Which exit type actually fired?
* Were exits driven by market behavior or model confidence?

---

## Exact Test Configuration

### Capital Allocation (Per Game)

* Model Edge: fixed cap
* Pregame Anchored: fixed cap
* Mean Reversion: fixed cap

(Exact dollar values intentionally omitted here — see runner config used on 02/06/2025.)

### Polling Cadence

* Market polling approximately every few seconds
* ESPN clock cached and refreshed on a short interval

### Pregame Entry Rules

* Entry window: final minutes before tip
* One attempt only
* Failure disables further pregame attempts for that game

### Live Trading Rules

* No re-entry after full exit
* Exit decisions evaluated continuously
* Lock attempts capped per position

---

## Logging & Observability Expectations

### Snapshot Logs

Each snapshot row should contain:

* Timestamp
* Ticker
* Market prices (bid/ask/mid)
* Market quality metrics
* ESPN live context (when available)

These snapshots are expected to support:

* Price path reconstruction
* Decision timing analysis
* ESPN vs. market comparison

### Trade Logs

For each trade we expect to reconstruct:

* Strategy responsible
* Entry reason
* Exit reason
* Fill vs no-fill outcomes

### Known Logging Limitations

* Partial fills are treated as atomic events
* Some strategy intent is implicit (derived later)

These limitations are accepted for this test.

---

## Success Criteria

This test is considered **successful** if:

1. All games run end-to-end without crashes
2. At least one strategy per game attempts to trade
3. PregameAnchoredStrategy attempts **at most one** pregame entry per game
4. Live strategies react to price movement as expected
5. Logs are internally consistent and parsable

Profitability is **not** a required success condition for this test.

---

## Failure Modes to Watch For

### Execution Failures

* Runner crash
* Strategy loop halting unexpectedly
* Orders not placed when conditions are clearly met

### Data Failures

* ESPN event not found → missing `secs_to_tip`
* ESPN win % missing during live play
* Market snapshots missing fields

### Strategy Logic Failures

* PregameAnchored re-attempting after failure
* Lock attempts exhausted without fills
* Mean reversion never activating despite volatility

---

## Post-Test Analysis Plan

After the run, analysis should include:

1. Timeline plots of price vs. trades
2. Breakdown of exits by type
3. ESPN win % vs market price divergence
4. Comparison of pregame vs live contribution to PnL
5. Identification of false positives / missed opportunities

This document should be referenced **before drawing conclusions** from results.

---

## Test Status

* Test Date: 2025-02-06
* Status: Prepared, awaiting execution
* Notes: Partner win % to be updated pregame

---

*This plan reflects intentional design decisions as of the morning of 02/06/2025. Any deviations during execution should be documented separately.*
